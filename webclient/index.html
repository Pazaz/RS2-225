<!DOCTYPE html>
<html>
    <head>
        <title>RuneScape 2</title>

        <script src="https://unpkg.com/pcm-player"></script>

        <script>
            const AudioContext =
                window.AudioContext || window.webkitAudioContext;

            const audioCtx = new AudioContext();

            function playWave(data, vol) {
                try {
                    audioCtx
                        .decodeAudioData(Uint8Array.from(data).buffer)
                        .then((buffer) => {
                            var track = audioCtx.createBufferSource();
                            track.buffer = buffer;
                            track.connect(audioCtx.destination);
                            track.start(0);
                        });
                } catch (err) {
                    // console.log(err);
                }
            }

            function setWaveVolume(vol) {
                console.log(vol);
            }

            function playMidi(data, vol) {
                console.log('playmidi');

                if (window._tinyMidiPlay) {
                    window._tinyMidiPlay(data);
                }
            }

            function setMidiVolume(vol) {
                console.log('midi volume', vol);
            }

            function stopMidi() {
                if (window._tinyMidiStop) {
                    window._tinyMidiStop();
                }
            }

            let _isLoaded = false;

            window.onclick = () => {
                if (!_isLoaded) {
                    main();
                }

                _isLoaded = true;
            };
        </script>

        <script type="module" src="/midi.js"></script>

        <script
            type="text/javascript"
            charset="utf-8"
            src="target/js/classes.js"
        ></script>
    </head>

    <body style="background-color: black">
        <canvas id="game" width="789" height="532"></canvas>
    </body>
</html>
